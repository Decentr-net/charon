<app-hub-statistics-card
  class="hub-pdv-statistics__card"
  *transloco="let translate; read: 'hub.hub_pdv_statistics'"
>
  <ng-container ngProjectAs="title">
    {{ translate('my_pdv') }}
  </ng-container>

  <ng-container *ngIf="statistics; else loader">
    <ng-container ngProjectAs="subtitle">
      {{ translate('activity_from', { date: statistics.fromDate | date }) }}
    </ng-container>

    <div class="hub-pdv-statistics__pdv">
      {{ statistics.pdv | pdvValue }}
    </div>

    <div class="hub-pdv-statistics__pdv-change">
      {{ translate('pdv_change.your_pdv') }}
      <ng-container *ngIf="isPositive || isNegative else notChangedPDV">
        <span class="hub-pdv-statistics__pdv-direction">
          {{ translate(
            'pdv_change.' + (isPositive ? 'increased' : 'decreased'),
            { percent: statistics.pdvChangedIn24HoursPercent | positiveNumber | number : '1.0-5' }
          ) }}
        </span>
      </ng-container>
      <ng-template #notChangedPDV>
        {{ translate('pdv_change.not_changed') }}
      </ng-template>
      {{ translate('pdv_change.last_hours') }}
    </div>

    <app-line-chart
      *ngIf="statistics.points.length > 1; else noData"
      class="hub-pdv-statistics__chart"
      color="#3796A4"
      [data]="statistics.points"
      [showArea]="true"
      [showHoverLine]="true"
      [showTooltip]="true"
    >
      <div
        *appLineChartTooltip="let chartPoint"
        class="hub-pdv-statistics__tooltip"
      >
        {{ chartPoint.value | pdvValue }} PDV
        <div class="hub-pdv-statistics__tooltip-date">
          {{ chartPoint.date | date }}
        </div>
      </div>
    </app-line-chart>

    <ng-template #noData>
      <div class="hub-pdv-statistics__no-data">
        <ng-container *ngIf="statistics.points.length === 1">{{ translate('not_enough_chart_data') }}</ng-container>
        <ng-container *ngIf="statistics.points.length < 1">{{ translate('no_chart_data') }}</ng-container>
      </div>
    </ng-template>
  </ng-container>

  <ng-template #loader>
    <div class="hub-pdv-statistics__loader-container">
      <app-spinner></app-spinner>
    </div>
  </ng-template>
</app-hub-statistics-card>
